<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœæ•°å­—æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        h1 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 32px;
        }
        .mode-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .mode-btn {
            padding: 15px 30px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 150px;
        }
        .mode-btn.primary {
            background: #667eea;
            color: white;
        }
        .mode-btn.primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        .mode-btn.secondary {
            background: #764ba2;
            color: white;
        }
        .mode-btn.secondary:hover {
            background: #6a3d91;
            transform: translateY(-2px);
        }
        .game-area {
            display: none;
            animation: fadeIn 0.3s;
        }
        .game-area.active {
            display: block;
        }
        .instruction {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: #495057;
            font-size: 14px;
            line-height: 1.6;
        }
        .guess-display {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 30px 0;
        }
        .input-area {
            margin: 30px 0;
        }
        .input-area input {
            width: 100%;
            padding: 15px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 20px;
        }
        .feedback-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        .feedback-btn {
            padding: 12px 25px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .feedback-btn.too-big {
            background: #ff6b6b;
            color: white;
        }
        .feedback-btn.too-small {
            background: #4ecdc4;
            color: white;
        }
        .feedback-btn.correct {
            background: #51cf66;
            color: white;
        }
        .feedback-btn:hover {
            transform: scale(1.05);
        }
        .feedback {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
        }
        .feedback.big {
            color: #ff6b6b;
            background: #fff5f5;
        }
        .feedback.small {
            color: #4ecdc4;
            background: #e3fafc;
        }
        .feedback.success {
            color: #51cf66;
            background: #ebfbee;
        }
        .attempts {
            font-size: 18px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .feedback-info {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 8px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback-info.big {
            color: #ff6b6b;
            background: #fff5f5;
        }

        .feedback-info.small {
            color: #4ecdc4;
            background: #e3fafc;
        }

        .feedback-info.success {
            color: #51cf66;
            background: #ebfbee;
        }

        .feedback-info.hidden {
            visibility: hidden;
        }

        .input-row {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            align-items: center;
        }

        .input-row input {
            flex: 1;
            padding: 15px;
            font-size: 20px;
            text-align: center;
            border: 2px solid #667eea;
            border-radius: 10px;
            min-width: 0;
        }

        .input-row .submit-btn {
            padding: 15px 30px;
            font-size: 18px;
            white-space: nowrap;
            margin: 0;
        }
        .submit-btn {
            background: #51cf66;
            color: white;
            padding: 15px 40px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .submit-btn:hover {
            background: #40c057;
            transform: translateY(-2px);
        }
        .restart-btn {
            background: #667eea;
            color: white;
            padding: 15px 30px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
         .restart-btn:hover {
             background: #5568d3;
         }
         .voice-controls {
             margin: 20px 0;
             text-align: center;
         }
         .voice-btn {
             background: #667eea;
             color: white;
             padding: 12px 25px;
             font-size: 16px;
             border: none;
             border-radius: 8px;
             cursor: pointer;
             transition: all 0.3s;
             display: inline-flex;
             align-items: center;
             gap: 8px;
             margin-bottom: 10px;
         }
         .voice-btn:hover {
             background: #5568d3;
             transform: scale(1.05);
         }
         .voice-btn.listening {
             background: #ff6b6b;
             animation: pulse 1.5s infinite;
         }
         .voice-btn.speaking {
             background: #4ecdc4;
         }
         .voice-status {
             font-size: 14px;
             color: #6c757d;
             min-height: 20px;
         }
         .voice-status.listening {
             color: #ff6b6b;
         }
         .voice-status.speaking {
             color: #4ecdc4;
         }
         @keyframes fadeIn {
             from { opacity: 0; transform: translateY(20px); }
             to { opacity: 1; transform: translateY(0); }
         }
         @keyframes pulse {
             0% { opacity: 1; }
             50% { opacity: 0.7; }
             100% { opacity: 1; }
         }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® çŒœæ•°å­—æ¸¸æˆ</h1>
        
        <div id="modeSelection">
            <div class="mode-buttons">
                <button class="mode-btn primary" onclick="startGame('userGuess')">ä½ æƒ³æˆ‘çŒœ</button>
                <button class="mode-btn secondary" onclick="startGame('computerGuess')">æˆ‘æƒ³ä½ çŒœ</button>
            </div>
        </div>

         <div id="userGuessGame" class="game-area">
             <div class="instruction">
                 æˆ‘æƒ³å¥½äº†ä¸€ä¸ª 1-100 ä¹‹é—´çš„æ•°å­—ï¼Œä½ æ¥çŒœçŒœçœ‹ï¼
             </div>
             <div id="feedbackInfo" class="feedback-info hidden"></div>
             <div class="attempts">å·²çŒœæ¬¡æ•°: <span id="userAttempts">0</span></div>
             <div class="input-row">
                 <input type="number" id="userGuessInput" min="1" max="100" placeholder="è¾“å…¥ä½ çš„çŒœæµ‹ (1-100)">
                 <button class="submit-btn" onclick="userGuess()">çŒœï¼</button>
             </div>
         </div>

         <div id="computerGuessGame" class="game-area">
             <div id="computerIntro" style="display: block;">
                 <div class="instruction">
                     è¯·ä½ åœ¨å¿ƒé‡Œæƒ³å¥½ä¸€ä¸ª 1-100 ä¹‹é—´çš„æ•°å­—ï¼Œæˆ‘ä¼šæ¥çŒœï¼
                 </div>
                 <button class="submit-btn" onclick="confirmReady()">æƒ³å¥½äº†</button>
             </div>
             <div id="computerPlaying" style="display: none;">
                 <div class="guess-display">æˆ‘çŒœ: <span id="computerGuess">?</span></div>
                 <div class="feedback-buttons">
                     <button class="feedback-btn too-big" onclick="computerFeedback('big')">å¤§äº†</button>
                     <button class="feedback-btn too-small" onclick="computerFeedback('small')">å°äº†</button>
                     <button class="feedback-btn correct" onclick="computerFeedback('correct')">å¯¹äº†</button>
                 </div>
                 <div class="attempts">æˆ‘å·²çŒœ: <span id="computerAttempts">0</span> æ¬¡</div>
             </div>
         </div>

        <div id="resultScreen" class="game-area">
            <div class="guess-display" id="resultMessage"></div>
            <div class="attempts">æ€»å…±çŒœäº† <span id="totalAttempts">0</span> æ¬¡</div>
            <button class="restart-btn" onclick="restartGame()">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

     <script>
         let currentMode = '';
         let targetNumber = 0;
         let userAttempts = 0;
         let computerAttempts = 0;
         let computerMin = 1;
         let computerMax = 100;
         let computerGuess = 0;
         
         let speechRecognition = null;
         let speechSynthesis = null;
         let isListening = false;
         let isSpeaking = false;

        function startGame(mode) {
            currentMode = mode;
            document.getElementById('modeSelection').style.display = 'none';

             if (mode === 'userGuess') {
                 targetNumber = Math.floor(Math.random() * 100) + 1;
                 userAttempts = 0;
                 document.getElementById('userAttempts').textContent = userAttempts;
                 document.getElementById('feedbackInfo').classList.add('hidden');
                 document.getElementById('userGuessInput').value = '';
                 document.getElementById('userGuessGame').classList.add('active');
            } else {
                computerMin = 1;
                computerMax = 100;
                computerAttempts = 0;
                document.getElementById('computerAttempts').textContent = computerAttempts;
                document.getElementById('computerGuessGame').classList.add('active');
                document.getElementById('computerIntro').style.display = 'block';
                document.getElementById('computerPlaying').style.display = 'none';
            }
        }

        function confirmReady() {
            document.getElementById('computerIntro').style.display = 'none';
            document.getElementById('computerPlaying').style.display = 'block';
            makeComputerGuess();
        }

         function userGuess() {
             const input = document.getElementById('userGuessInput');
             const guess = parseInt(input.value);
             
             if (isNaN(guess) || guess < 1 || guess > 100) {
                 alert('è¯·è¾“å…¥ 1-100 ä¹‹é—´çš„æ•°å­—ï¼');
                 return;
             }
             
              userAttempts++;
              document.getElementById('userAttempts').textContent = userAttempts;
              
              const feedbackInfo = document.getElementById('feedbackInfo');
              feedbackInfo.classList.remove('hidden');
              
              if (guess > targetNumber) {
                  feedbackInfo.textContent = 'ğŸ”¼ å¤§äº†ï¼';
                  feedbackInfo.className = 'feedback-info big';
              } else if (guess < targetNumber) {
                  feedbackInfo.textContent = 'ğŸ”½ å°äº†ï¼';
                  feedbackInfo.className = 'feedback-info small';
              } else {
                  feedbackInfo.textContent = 'ğŸ‰ æ­å–œä½ ï¼ŒçŒœå¯¹äº†ï¼';
                  feedbackInfo.className = 'feedback-info success';
                  showResult('user', userAttempts);
              }
            
             input.value = '';
             input.focus();
             
             if (guess === targetNumber) {
                 speakSuccess();
             } else if (guess > targetNumber) {
                 speakTooBig();
             } else {
                 speakTooSmall();
             }
         }

         function makeComputerGuess() {
             computerGuess = Math.floor((computerMin + computerMax) / 2);
             document.getElementById('computerGuess').textContent = computerGuess;
            //  if (computerGuess !== 0) {
            //      speakText('æˆ‘çŒœæ˜¯' + computerGuess);
            //  }
         }

         function computerFeedback(feedback) {
             computerAttempts++;
             document.getElementById('computerAttempts').textContent = computerAttempts;

             if (feedback === 'big') {
                 computerMax = computerGuess - 1;
                 makeComputerGuess();
                 speakText('å¤§äº†ï¼Ÿé‚£æˆ‘çŒœ' + computerGuess);
             } else if (feedback === 'small') {
                 computerMin = computerGuess + 1;
                 makeComputerGuess();
                 speakText('å°äº†ï¼Ÿé‚£æˆ‘çŒœ' + computerGuess);
             } else {
                 showResult('computer', computerAttempts);
                 speakSuccess();
             }
         }

        function showResult(winner, attempts) {
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            
            const resultScreen = document.getElementById('resultScreen');
            const resultMessage = document.getElementById('resultMessage');
            document.getElementById('totalAttempts').textContent = attempts;
            
             if (winner === 'user') {
                 resultMessage.textContent = 'ğŸ‰ æ­å–œä½ çŒœå¯¹äº†ï¼';
                 speakSuccess();
             } else {
                 resultMessage.textContent = 'ğŸ¤– æˆ‘çŒœå¯¹äº†ï¼';
                 speakSuccess();
             }
            
            resultScreen.classList.add('active');
        }

        function restartGame() {
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            document.getElementById('modeSelection').style.display = 'block';
        }

         document.getElementById('userGuessInput').addEventListener('keypress', function(e) {
             if (e.key === 'Enter') {
                 userGuess();
             }
         });
         
         // è¯­éŸ³è¾“å‡ºå‡½æ•°
         function speakText(text) {
             if (!('speechSynthesis' in window)) {
                 console.error('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ');
                 return;
             }

             if (isSpeaking) {
                 speechSynthesis.cancel();
             }

             const utterance = new SpeechSynthesisUtterance(text);
             utterance.lang = 'zh-CN';
             utterance.rate = 1.0;
             utterance.pitch = 1.8; // è®¾ç½®ä¸ºå„¿ç«¥éŸ³è‰²ï¼ˆè¾ƒé«˜éŸ³è°ƒï¼‰
             utterance.volume = 1.0;

             utterance.onstart = function() {
                 isSpeaking = true;
                 console.log('å¼€å§‹è¯­éŸ³è¾“å‡º:', text);
             };

             utterance.onend = function() {
                 isSpeaking = false;
                 console.log('è¯­éŸ³è¾“å‡ºç»“æŸ:', text);
             };

             utterance.onerror = function(event) {
                 isSpeaking = false;
                 console.error('è¯­éŸ³è¾“å‡ºé”™è¯¯:', event);
             };

             speechSynthesis.speak(utterance);
         }
         
         // ç‰¹å®šè¯­éŸ³è¾“å‡ºå‡½æ•°
         function speakTooBig() {
             speakText('å¤§äº†');
         }
         
         function speakTooSmall() {
             speakText('å°äº†');
         }
         
         function speakSuccess() {
             speakText('çŒœå¯¹äº†');
         }
         
         // åˆå§‹åŒ–è¯­éŸ³åˆæˆ
         function initSpeechSynthesis() {
             if ('speechSynthesis' in window) {
                 speechSynthesis = window.speechSynthesis;
             } else {
                 console.error('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ');
             }
         }
         
         // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
         window.addEventListener('load', function() {
             initSpeechSynthesis();
         });
     </script>
</body>
</html>
